<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Cinema project Greeting page</title>
<!--    <meta name="viewport" content="width=device-width, initial-scale=2">-->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script>
        function redirect() {
            document.location.href = location.origin + '/cinema/hall.do'
        }

        //TODO !!! fix URL HERE

        function login() {
            const email = $('#email').val()
            const password = $('#password').val()
            $.post({
                url: location.origin + '/cinema/auth',
                data: {
                    "action" : 'login',
                    "email": email,
                    "password": password
                }
            }).done(function () {
                redirect()
            }).fail(function () {
                $('#hint').text("Неверный логин или пароль")
            });
        }

        function reg() {
            const newName = $('#validationName').val()
            const newEmail = $('#validationEmail').val()
            const newPassword = $('#validationPWD').val()
            $.post({
                url: location.origin + '/cinema/auth',
                data: {
                    "action" : 'reg',
                    "name" : newName,
                    "email": newEmail,
                    "password": newPassword
                }
            }).done(function () {
                $('#hint').text("Пользователь успешно зарегистрирован.")
                $('#validationName').text('')
                $('#validationEmail').text('')
                $('#validationPWD').text('')
            }).fail(function () {
                $('#hint').text("Ошибка регистрации")
            });
        }
    </script>
</head>
<body>



<div class="container">
    <div class="row">
        <nav class="navbar navbar-light bg-light">
            <div class="container-fluid">
                <a class="navbar-brand" href="#">
                    <img src="/img/brand.png" width="204" height="131" class="d-inline-block align-top" alt="">
                    Cinema project
                </a>
                <div class="card">
                    <div class="card-body" id="card_hint">
                        <label for="card_hint" id="hint"></label>
                    </div>
                </div>
            </div>
        </nav>
    </div>

    <div class="row">
        <div class="col-lg">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title">Login</h5>
                    <p class="card-text">Input your credentials to login.</p>
                    <!--                </div>-->
                    <!--                <div class="card-body">-->
                    <div class="mb-3">
                        <input type="text" class="form-control" placeholder="email" id="email" aria-label="Email"
                               aria-describedby="basic-addon1">
                    </div>
                    <div class="mb-3">
                        <input type="password" class="form-control" placeholder="password" id="password"
                               aria-label="PWD"
                               aria-describedby="basic-addon2">
                    </div>
                    <button type="submit" class="btn btn-primary" onclick="login()">Войти</button>
                </div>
            </div>
        </div>
        <div class="col-lg">
            <div class="card">
                <form class="row g-3 needs-validation" novalidate>
                    <div class="col-md-4">
                        <input type="text" class="form-control" id="validationName" placeholder="Имя пользователя"
                               required>
                        <div class="invalid-feedback">
                            Введите имя пользователя.
                        </div>
                    </div>
                    <div class="col-md-4">
                        <input type="email" name="validationEmail" placeholder="Email"
                               class="email white col-7 col-md-4 col-lg-7 ml-3 form-control" id="validationEmail"
                               pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$" required>
                        <div class="invalid-feedback">
                            Введите email.
                        </div>
                    </div>
                    <div class="col-md-4">
                        <input type="password" class="form-control" id="validationPWD" placeholder="Пароль"
                               required>
                        <div class="invalid-feedback">
                            Введите пароль.
                        </div>
                    </div>
                    <div class="col-5">
                        <button type="submit" class="btn btn-primary" onclick="reg()">Зарегистрировать</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
</body>
</html>
